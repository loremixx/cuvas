<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8">
  <title>√áuva≈ü√ßa ƒ∞yelik √áekimleyici</title>
  <script defer src="https://pyscript.net/latest/pyscript.js"></script>
  <style>
    body {
      font-family: Arial, sans-serif;
      max-width: 800px;
      margin: 40px auto;
      text-align: center;
    }
    input, select, button {
      padding: 8px;
      margin: 5px;
      font-size: 16px;
    }
    #sonuc {
      margin-top: 20px;
      font-weight: bold;
      font-size: 20px;
      color: darkblue;
    }
  </style>
</head>
<body>
  <h1>√áuva≈ü√ßa ƒ∞yelik Eki √áekimleyici</h1>
  <p>Kelimeyi gir, ≈üahƒ±s se√ß, √ßoƒüul iste ‚Üí sonucu g√∂r üéâ</p>

  <input id="kelime" type="text" placeholder="Kelimeyi gir">
  <select id="sahis">
    <option value="1sg">1sg (benim)</option>
    <option value="2sg">2sg (senin)</option>
    <option value="3sg">3sg (onun)</option>
    <option value="1pl">1pl (bizim)</option>
    <option value="2pl">2pl (sizin)</option>
    <option value="3pl">3pl (onlarƒ±n)</option>
  </select>
  <label>
    <input id="cogul" type="checkbox"> √áoƒüul ekle
  </label>
  <button onclick="cekimle()">√áekimle</button>

  <div id="sonuc">Sonu√ß burada g√∂r√ºnecek</div>

  <py-script>
# -*- coding: utf-8 -*-
from js import document

VOWELS = {'–∞','”ë','—ã','—É','—ç','”ó','–∏','”≥'}
CONSONANTS = {'–π','—Ü','–∫','–Ω','–≥','—à','—â','–∑','—Ö','—Ñ','–≤','–ø','—Ä','–ª','–¥','–∂','—á','—Å','–º','—Ç','–±','—é','—è'}
BACK_VOWELS = {'–∞','”ë','—ã','—É'}
FRONT_VOWELS = {'—ç','”ó','–∏','”≥'}

def get_vowel_harmony(word):
    for char in reversed(word):
        if char in BACK_VOWELS:
            return 'back'
        elif char in FRONT_VOWELS:
            return 'front'
    return 'back'

def get_last_letter_type(word):
    if not word: return 'consonant'
    return 'vowel' if word[-1] in VOWELS else 'consonant'

def has_single_consonant_before_ƒÉƒï(word):
    if len(word) >= 2 and word[-1] in {'”ë','”ó'}:
        if word[-2] in CONSONANTS:
            vowel_count = sum(1 for char in word if char in VOWELS)
            return vowel_count >= 2
    return False

def add_first_singular_possessive(word):
    if not word: return word
    harmony = get_vowel_harmony(word)
    last_char = word[-1]
    if last_char in {'—É','”≥'}:
        return word[:-1] + ('”ë–≤”ë–º' if harmony=='back' else '”ó–≤”ó–º')
    if has_single_consonant_before_ƒÉƒï(word):
        c = word[-2]
        stem = word[:-2] + c*2
        return stem + word[-1] + '–º'
    if get_last_letter_type(word) == 'consonant':
        return word + ('”ë–º' if harmony=='back' else '”ó–º')
    return word + '–º'

def add_second_singular_possessive(word):
    if not word: return word
    harmony = get_vowel_harmony(word)
    last_char = word[-1]
    suffix = '—É' if harmony=='back' else '”≥'
    if last_char in {'–∞','—ç'}:
        return word[:-1] + suffix
    if has_single_consonant_before_ƒÉƒï(word):
        c = word[-2]
        stem = word[:-2] + c*2
        return stem + suffix
    return word + suffix

def add_third_singular_possessive(word):
    if not word: return word
    harmony = get_vowel_harmony(word)
    last_char = word[-1]
    if last_char in {'—Ç','–¥'}:
        return word[:-1] + '—á”ó'
    if last_char in {'—É','”≥'}:
        return word[:-1] + ('”ë–≤”ó' if harmony=='back' else '”ó–≤”ó')
    if last_char == '–∏':
        return word + '–π”ó'
    if last_char in {'–∞','—ç','”ë','”ó'}:
        if last_char in {'”ë','”ó'} and has_single_consonant_before_ƒÉƒï(word):
            c = word[-2]
            stem = word[:-2] + c*2
            return stem + '”ó'
        else:
            return word[:-1] + '”ó'
    return word + '”ó'

def add_first_plural_possessive(word):
    if not word: return word
    harmony = get_vowel_harmony(word)
    last_char = word[-1]
    if last_char in {'—É','”≥'}:
        return word[:-1] + ('”ë–≤”ë–º”ë—Ä' if harmony=='back' else '”ó–≤”ó–º”ó—Ä')
    if has_single_consonant_before_ƒÉƒï(word):
        c = word[-2]
        stem = word[:-2] + c*2
        return stem + word[-1] + ('–º”ë—Ä' if harmony=='back' else '–º”ó—Ä')
    if get_last_letter_type(word) == 'consonant':
        return word + ('”ë–º”ë—Ä' if harmony=='back' else '”ó–º”ór')
    return word + ('–º”ë—Ä' if harmony=='back' else '–º”ó—Ä')

def add_second_plural_possessive(word):
    if not word: return word
    harmony = get_vowel_harmony(word)
    last_char = word[-1]
    if last_char in {'—É','”≥'}:
        return word[:-1] + ('”ë–≤”ë—Ä' if harmony=='back' else '”ó–≤”ó—Ä')
    if has_single_consonant_before_ƒÉƒï(word):
        c = word[-2]
        stem = word[:-2] + c*2
        return stem + ('”ë—Ä' if harmony=='back' else '”ó—Ä')
    if get_last_letter_type(word) == 'consonant':
        return word + ('”ë—Ä' if harmony=='back' else '”ó—Ä')
    return word + '—Ä'

def add_third_plural_possessive(word):
    return add_third_singular_possessive(word)

def add_plural_suffix(word):
    return word + '—Å–µ–º'

def conjugate_chuvash(word, person, plural=False):
    if not word: return word
    if person == '1sg': result = add_first_singular_possessive(word)
    elif person == '2sg': result = add_second_singular_possessive(word)
    elif person == '3sg': result = add_third_singular_possessive(word)
    elif person == '1pl': result = add_first_plural_possessive(word)
    elif person == '2pl': result = add_second_plural_possessive(word)
    elif person == '3pl': result = add_third_plural_possessive(word)
    else: result = word
    if plural: result = add_plural_suffix(result)
    return result

def cekimle():
    kelime = document.getElementById("kelime").value.strip()
    sahis = document.getElementById("sahis").value
    cogul = document.getElementById("cogul").checked
    sonuc = conjugate_chuvash(kelime, sahis, cogul)
    document.getElementById("sonuc").innerText = f"Sonu√ß: {sonuc}"
  </py-script>
</body>
      </html>
